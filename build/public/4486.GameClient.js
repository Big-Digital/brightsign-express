"use strict";(self.webpackChunkGameClient=self.webpackChunkGameClient||[]).push([[4486],{3150:(e,s,t)=>{t.d(s,{z:()=>a});class a{constructor(e,s){this._gltf=e,this._infoTree=s}convert(e){let s,t=this._gltf,a=this._infoTree;if(!e.startsWith("/"))throw new Error("Path must start with a /");const n=e.split("/");n.shift();for(const o of n){if(a.__array__)a=a.__array__;else if(a=a[o],!a)throw new Error(`Path ${e} is invalid`);if(void 0===t)throw new Error(`Path ${e} is invalid`);t=t[o],a.__target__&&(s=t)}return{object:s,info:a}}}},4486:(e,s,t)=>{t.d(s,{KHR_interactivity:()=>Ks});var a,n=t(3054),o=t(7634),r=t(5686),i=t(9732);!function(e){e[e.Input=0]="Input",e[e.Output=1]="Output"}(a||(a={}));class c{constructor(e,s,t){this._ownerBlock=t,this._connectedPoint=[],this.uniqueId=(0,o.z)(),this.connectedPointIds=[],this.name=e,this._connectionType=s}get connectionType(){return this._connectionType}_isSingularConnection(){return!0}isConnected(){return this._connectedPoint.length>0}connectTo(e){if(this._connectionType===e._connectionType)throw new Error(`Cannot connect two points of type ${this.connectionType}`);if(this._isSingularConnection()&&this._connectedPoint.length>0||e._isSingularConnection()&&e._connectedPoint.length>0)throw new Error("Max number of connections for point reached");this._connectedPoint.push(e),e._connectedPoint.push(this)}serialize(e={}){e.uniqueId=this.uniqueId,e.name=this.name,e._connectionType=this._connectionType,e.connectedPointIds=[],e.className=this.getClassName();for(const s of this._connectedPoint)e.connectedPointIds.push(s.uniqueId)}getClassName(){return"FGConnection"}deserialize(e){this.uniqueId=e.uniqueId,this.name=e.name,this._connectionType=e._connectionType,this.connectedPointIds=e.connectedPointIds}static Parse(e={},s){const t=new(i.S0.Instantiate(e.className))(e.name,e._connectionType,s);return t.deserialize(e),t}}var l=t(4049),u=t(451);class h{constructor(e){this.value=this._toInt(e)}_toInt(e){return 0|e}add(e){return new h(this.value+e.value)}subtract(e){return new h(this.value-e.value)}multiply(e){return new h(Math.imul(this.value,e.value))}divide(e){return new h(this.value/e.value)}getClassName(){return h.ClassName}equals(e){return this.value===e.value}static Parse(e){return new h(e.value)}}h.ClassName="FlowGraphInteger",(0,r.Y5)("FlowGraphInteger",h);class m{constructor(e,s){this.typeName=e,this.defaultValue=s}serialize(e){e.typeName=this.typeName,e.defaultValue=this.defaultValue}static Parse(e){return new m(e.typeName,e.defaultValue)}}const p=new m("any",void 0),d=(new m("string",""),new m("number",0)),C=new m("boolean",!1),N=new m("Vector2",l.I9.Zero()),_=new m("Vector3",l.Pq.Zero()),g=(new m("Vector4",l.IU.Zero()),new m("Matrix",l.uq.Identity())),f=(new m("Color3",u.v9.Black()),new m("Color4",new u.ov(0,0,0,0)),new m("Quaternion",l.PT.Identity()),new m("FlowGraphInteger",new h(0)));class v extends c{constructor(e,s,t,a){super(e,s,t),this.richType=a}_isSingularConnection(){return 0===this.connectionType}setValue(e,s){s._setConnectionValue(this,e)}connectTo(e){super.connectTo(e)}_getValueOrDefault(e){return e._hasConnectionValue(this)?e._getConnectionValue(this):this.richType.defaultValue}getValue(e){return 1===this.connectionType?(e._notifyExecuteNode(this._ownerBlock),this._ownerBlock._updateOutputs(e),this._getValueOrDefault(e)):this.isConnected()?this._connectedPoint[0].getValue(e):this._getValueOrDefault(e)}getClassName(){return"FGDataConnection"}serialize(e={}){super.serialize(e),e.richType={},this.richType.serialize(e.richType)}static Parse(e,s){const t=c.Parse(e,s);return t.richType=m.Parse(e.richType),t}}function x(e){return"Mesh"===e||"AbstractMesh"===e||"GroundMesh"===e||"InstanceMesh"===e||"LinesMesh"===e||"GoldbergMesh"===e||"GreasedLineMesh"===e||"TrailMesh"===e}function y(e){return"Vector2"===e||"Vector3"===e||"Vector4"===e||"Quaternion"===e||"Color3"===e||"Color4"===e}function w(e,s,t){const a=s?.getClassName?.()??"";x(a)?t[e]={name:s.name,className:a}:y(a)?t[e]={value:s.asArray(),className:a}:t[e]=s}function I(e,s,t){const a=s[e];let n;const o=a?.className;return n=x(o)?t.getMeshByName(a.name):y(o)?function(e,s){if("Vector2"===e)return l.I9.FromArray(s);if("Vector3"===e)return l.Pq.FromArray(s);if("Vector4"===e)return l.IU.FromArray(s);if("Quaternion"===e)return l.PT.FromArray(s);if("Color3"===e)return new u.v9(s[0],s[1],s[2]);if("Color4"===e)return new u.ov(s[0],s[1],s[2],s[3]);throw new Error(`Unknown vector class name ${e}`)}(o,a.value):"Matrix"===o?l.uq.FromArray(a.value):o===h.ClassName?h.Parse(a):a&&void 0!==a.value?a.value:a,n}(0,r.Y5)("FGDataConnection",v);class b{constructor(e){this.config=e,this.uniqueId=(0,o.z)(),this.name=this.config?.name??this.getClassName(),this.dataInputs=[],this.dataOutputs=[]}_updateOutputs(e){}registerDataInput(e,s){const t=new v(e,0,this,s);return this.dataInputs.push(t),t}registerDataOutput(e,s){const t=new v(e,1,this,s);return this.dataOutputs.push(t),t}getDataInput(e){return this.dataInputs.find((s=>s.name===e))}getDataOutput(e){return this.dataOutputs.find((s=>s.name===e))}serialize(e={},s=w){e.uniqueId=this.uniqueId,e.config={},this.config&&(e.config.name=this.config.name),e.dataInputs=[],e.dataOutputs=[],e.className=this.getClassName();for(const s of this.dataInputs){const t={};s.serialize(t),e.dataInputs.push(t)}for(const s of this.dataOutputs){const t={};s.serialize(t),e.dataOutputs.push(t)}}getClassName(){return"FGBlock"}static Parse(e,s){const t=i.S0.Instantiate(e.className),a={},n=s.valueParseFunction??I;if(e.config)for(const t in e.config)a[t]=n(t,e.config,s.scene);var o;("FGSetPropertyBlock"===(o=e.className)||"FGGetPropertyBlock"===o||"FGPlayAnimationBlock"===o||"FGMeshPickEventBlock"===o)&&(a.pathConverter=s.pathConverter);const r=new t(a);r.uniqueId=e.uniqueId;for(let s=0;s<e.dataInputs.length;s++){const t=r.getDataInput(e.dataInputs[s].name);if(!t)throw new Error("Could not find data input with name "+e.dataInputs[s].name+" in block "+e.className);t.deserialize(e.dataInputs[s])}for(let s=0;s<e.dataOutputs.length;s++){const t=r.getDataOutput(e.dataOutputs[s].name);if(!t)throw new Error("Could not find data output with name "+e.dataOutputs[s].name+" in block "+e.className);t.deserialize(e.dataOutputs[s])}return r.metadata=e.metadata,r.deserialize&&r.deserialize(e),r}}class k extends c{_isSingularConnection(){return 1===this.connectionType}_activateSignal(e){0===this.connectionType?(e._notifyExecuteNode(this._ownerBlock),this._ownerBlock._execute(e,this),e._increaseExecutionId()):this._connectedPoint[0]?._activateSignal(e)}}(0,r.Y5)("FlowGraphSignalConnection",k);class B extends b{constructor(e){super(e),this.signalInputs=[],this.signalOutputs=[],this.in=this._registerSignalInput("in")}_registerSignalInput(e){const s=new k(e,0,this);return this.signalInputs.push(s),s}_registerSignalOutput(e){const s=new k(e,1,this);return this.signalOutputs.push(s),s}getSignalInput(e){return this.signalInputs.find((s=>s.name===e))}getSignalOutput(e){return this.signalOutputs.find((s=>s.name===e))}serialize(e={}){super.serialize(e),e.signalInputs=[],e.signalOutputs=[];for(const s of this.signalInputs){const t={};s.serialize(t),e.signalInputs.push(t)}for(const s of this.signalOutputs){const t={};s.serialize(t),e.signalOutputs.push(t)}}deserialize(e){for(let s=0;s<e.signalInputs.length;s++){const t=this.getSignalInput(e.signalInputs[s].name);if(!t)throw new Error("Could not find signal input with name "+e.signalInputs[s].name+" in block "+e.className);t.deserialize(e.signalInputs[s])}for(let s=0;s<e.signalOutputs.length;s++){const t=this.getSignalOutput(e.signalOutputs[s].name);if(!t)throw new Error("Could not find signal output with name "+e.signalOutputs[s].name+" in block "+e.className);t.deserialize(e.signalOutputs[s])}}getClassName(){return"FGExecutionBlock"}}class V extends B{constructor(e){super(e),this.out=this._registerSignalOutput("out"),this.done=this._registerSignalOutput("done")}_startPendingTasks(e){this._preparePendingTasks(e),e._addPendingBlock(this)}}class G extends V{_execute(e){e._notifyExecuteNode(this),this.out._activateSignal(e)}}var F=t(4754),E=t(4537);class O{constructor(e){this.uniqueId=(0,o.z)(),this._userVariables={},this._executionVariables={},this._connectionValues={},this._pendingBlocks=[],this._executionId=0,this.onNodeExecutedObservable=new n.cP,this._configuration=e}hasVariable(e){return e in this._userVariables}setVariable(e,s){this._userVariables[e]=s}getVariable(e){return this._userVariables[e]}get userVariables(){return this._userVariables}_getUniqueIdPrefixedName(e,s){return`${e.uniqueId}_${s}`}_setExecutionVariable(e,s,t){this._executionVariables[this._getUniqueIdPrefixedName(e,s)]=t}_getExecutionVariable(e,s,t){return this._hasExecutionVariable(e,s)?this._executionVariables[this._getUniqueIdPrefixedName(e,s)]:t}_deleteExecutionVariable(e,s){delete this._executionVariables[this._getUniqueIdPrefixedName(e,s)]}_hasExecutionVariable(e,s){return this._getUniqueIdPrefixedName(e,s)in this._executionVariables}_hasConnectionValue(e){return e.uniqueId in this._connectionValues}_setConnectionValue(e,s){this._connectionValues[e.uniqueId]=s}_getConnectionValue(e){return this._connectionValues[e.uniqueId]}get configuration(){return this._configuration}_addPendingBlock(e){this._pendingBlocks.push(e)}_removePendingBlock(e){const s=this._pendingBlocks.indexOf(e);-1!==s&&this._pendingBlocks.splice(s,1)}_clearPendingBlocks(){for(const e of this._pendingBlocks)e._cancelPendingTasks(this);this._pendingBlocks.length=0}_notifyExecuteNode(e){this.onNodeExecutedObservable.notifyObservers(e)}_increaseExecutionId(){this._executionId++}get executionId(){return this._executionId}serialize(e={},s=w){e.uniqueId=this.uniqueId,e._userVariables={};for(const t in this._userVariables)s(t,this._userVariables[t],e._userVariables);e._connectionValues={};for(const t in this._connectionValues)s(t,this._connectionValues[t],e._connectionValues)}getClassName(){return"FGContext"}static Parse(e,s){const t=s.graph.createContext(),a=s.valueParseFunction??I;t.uniqueId=e.uniqueId;for(const s in e._userVariables){const n=a(s,e._userVariables,t._configuration.scene);t._userVariables[s]=n}for(const s in e._connectionValues){const n=a(s,e._connectionValues,t._configuration.scene);t._connectionValues[s]=n}return t}}(0,F.Cg)([(0,E.lK)()],O.prototype,"uniqueId",void 0);var P,T=t(9039),q=t(3846);function M(e,s){return!(!e.parent||e.parent!==s&&!M(e.parent,s))}class Y extends G{constructor(e){super(e),this.config=e}_getReferencedMesh(){const e=this.config.pathConverter.convert(this.config.path),s=e.info.getObject(e.object);if(!(s&&s instanceof T.u))throw new Error("Mesh pick event block requires a valid mesh");return s}_preparePendingTasks(e){let s=e._getExecutionVariable(this,"meshPickObserver");if(!s){const t=this._getReferencedMesh();e._setExecutionVariable(this,"mesh",t),s=t.getScene().onPointerObservable.add((s=>{s.type===q.Zp.POINTERPICK&&s.pickInfo?.pickedMesh&&(s.pickInfo?.pickedMesh===t||M(s.pickInfo?.pickedMesh,t))&&this._execute(e)}));const a=t.onDisposeObservable.add((()=>this._onDispose));e._setExecutionVariable(this,"meshPickObserver",s),e._setExecutionVariable(this,"meshDisposeObserver",a)}}_onDispose(e){this._cancelPendingTasks(e),e._removePendingBlock(this)}_cancelPendingTasks(e){const s=e._getExecutionVariable(this,"mesh"),t=e._getExecutionVariable(this,"meshPickObserver"),a=e._getExecutionVariable(this,"meshDisposeObserver");s.getScene().onPointerObservable.remove(t),s.onDisposeObservable.remove(a),e._deleteExecutionVariable(this,"mesh"),e._deleteExecutionVariable(this,"meshPickObserver"),e._deleteExecutionVariable(this,"meshDisposeObserver")}getClassName(){return Y.ClassName}serialize(e){super.serialize(e),e.config.path=this.config.path}}Y.ClassName="FGMeshPickEventBlock",(0,r.Y5)(Y.ClassName,Y),function(e){e[e.Stopped=0]="Stopped",e[e.Started=1]="Started"}(P||(P={}));class S{constructor(e){this._eventBlocks=[],this._executionContexts=[],this.state=0,this._scene=e.scene,this._coordinator=e.coordinator,this._sceneDisposeObserver=this._scene.onDisposeObservable.add((()=>this.dispose()))}createContext(){const e=new O({scene:this._scene,coordinator:this._coordinator});return this._executionContexts.push(e),e}getContext(e){return this._executionContexts[e]}addEventBlock(e){this._eventBlocks.push(e)}start(){if(1!==this.state){this.state=1,0===this._executionContexts.length&&this.createContext();for(const e of this._executionContexts){const s=this._getContextualOrder();for(const t of s)t._startPendingTasks(e)}}}_getContextualOrder(){const e=[];for(const s of this._eventBlocks)if(s.getClassName()===Y.ClassName){const t=s._getReferencedMesh();let a=0;for(;a<e.length;a++){const s=e[a]._getReferencedMesh();if(t&&s&&M(t,s))break}e.splice(a,0,s)}else e.push(s);return e}dispose(){if(0!==this.state){this.state=0;for(const e of this._executionContexts)e._clearPendingBlocks();this._executionContexts.length=0,this._eventBlocks.length=0,this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null}}visitAllBlocks(e){const s=[],t=new Set;for(const e of this._eventBlocks)s.push(e),t.add(e.uniqueId);for(;s.length>0;){const a=s.pop();e(a);for(const e of a.dataInputs)for(const a of e._connectedPoint)t.has(a._ownerBlock.uniqueId)||(s.push(a._ownerBlock),t.add(a._ownerBlock.uniqueId));if(a instanceof B)for(const e of a.signalOutputs)for(const a of e._connectedPoint)t.has(a._ownerBlock.uniqueId)||(s.push(a._ownerBlock),t.add(a._ownerBlock.uniqueId))}}serialize(e={},s){e.allBlocks=[],this.visitAllBlocks((s=>{const t={};s.serialize(t),e.allBlocks.push(t)})),e.executionContexts=[];for(const t of this._executionContexts){const a={};t.serialize(a,s),e.executionContexts.push(a)}}static GetDataOutConnectionByUniqueId(e,s){for(const t of e)for(const e of t.dataOutputs)if(e.uniqueId===s)return e;throw new Error("Could not find data out connection with unique id "+s)}static GetSignalInConnectionByUniqueId(e,s){for(const t of e)if(t instanceof B)for(const e of t.signalInputs)if(e.uniqueId===s)return e;throw new Error("Could not find signal in connection with unique id "+s)}static Parse(e,s){const t=s.coordinator.createGraph(),a=[],n=s.valueParseFunction??I;for(const o of e.allBlocks){const e=b.Parse(o,{scene:s.coordinator.config.scene,pathConverter:s.pathConverter,valueParseFunction:n});a.push(e),e instanceof G&&t.addEventBlock(e)}for(const e of a){for(const s of e.dataInputs)for(const e of s.connectedPointIds){const t=S.GetDataOutConnectionByUniqueId(a,e);s.connectTo(t)}if(e instanceof B)for(const s of e.signalOutputs)for(const e of s.connectedPointIds){const t=S.GetSignalInConnectionByUniqueId(a,e);s.connectTo(t)}}for(const s of e.executionContexts)O.Parse(s,{graph:t,valueParseFunction:n});return t}}class D{constructor(e){this.config=e,this._flowGraphs=[],this._customEventsMap=new Map,this.config.scene.onDisposeObservable.add((()=>{this.dispose()})),(D.SceneCoordinators.get(this.config.scene)??[]).push(this)}createGraph(){const e=new S({scene:this.config.scene,coordinator:this});return this._flowGraphs.push(e),e}removeGraph(e){const s=this._flowGraphs.indexOf(e);-1!==s&&(e.dispose(),this._flowGraphs.splice(s,1))}start(){this._flowGraphs.forEach((e=>e.start()))}dispose(){this._flowGraphs.forEach((e=>e.dispose())),this._flowGraphs.length=0;const e=D.SceneCoordinators.get(this.config.scene)??[],s=e.indexOf(this);-1!==s&&e.splice(s,1)}serialize(e,s){e._flowGraphs=[],this._flowGraphs.forEach((t=>{const a={};t.serialize(a,s),e._flowGraphs.push(a)}))}static Parse(e,s){const t=s.valueParseFunction??I,a=new D({scene:s.scene});return e._flowGraphs?.forEach((e=>{S.Parse(e,{coordinator:a,valueParseFunction:t,pathConverter:s.pathConverter})})),a}get flowGraphs(){return this._flowGraphs}getCustomEventObservable(e){let s=this._customEventsMap.get(e);return s||(s=new n.cP,this._customEventsMap.set(e,s)),s}notifyCustomEvent(e,s){const t=this._customEventsMap.get(e);t&&t.notifyObservers(s)}}D.SceneCoordinators=new Map;class z extends G{_preparePendingTasks(e){if(!e._getExecutionVariable(this,"sceneReadyObserver")){const s=e.configuration.scene.onReadyObservable.add((()=>{this._execute(e)}));e._setExecutionVariable(this,"sceneReadyObserver",s)}}_cancelPendingTasks(e){const s=e._getExecutionVariable(this,"sceneReadyObserver");e.configuration.scene.onReadyObservable.remove(s),e._deleteExecutionVariable(this,"sceneReadyObserver")}getClassName(){return z.ClassName}}z.ClassName="FGSceneReadyEventBlock",(0,r.Y5)("FGSceneReadyEventBlock",z);class R extends G{_preparePendingTasks(e){if(!e._getExecutionVariable(this,"sceneBeforeRender")){const s=e.configuration.scene.onBeforeRenderObservable.add((()=>{this._execute(e)}));e._setExecutionVariable(this,"sceneBeforeRender",s)}}_cancelPendingTasks(e){const s=e._getExecutionVariable(this,"sceneBeforeRender");e.configuration.scene.onBeforeRenderObservable.remove(s),e._deleteExecutionVariable(this,"sceneBeforeRender")}getClassName(){return R.ClassName}}R.ClassName="FGSceneTickEventBlock",(0,r.Y5)(R.ClassName,R);class A extends B{constructor(e){super(e),this.out=this._registerSignalOutput("out")}}var $=t(3039);class L extends A{constructor(e){super(e),this.message=this.registerDataInput("message",p)}_execute(e){const s=this.message.getValue(e);$.V.Log(s),this.out._activateSignal(e)}getClassName(){return L.ClassName}}L.ClassName="FGConsoleLogBlock",(0,r.Y5)(L.ClassName,L);var U=t(7230);class K extends V{constructor(e){super(e),this.timeout=this.registerDataInput("timeout",d)}_preparePendingTasks(e){const s=this.timeout.getValue(e);if(void 0!==s&&s>=0){const t=e._getExecutionVariable(this,"runningTimers")||[],a=e.configuration.scene,n=new U.Qz({timeout:s,contextObservable:a.onBeforeRenderObservable,onEnded:()=>this._onEnded(n,e)});n.start(),t.push(n),e._setExecutionVariable(this,"runningTimers",t)}}_execute(e){this._startPendingTasks(e),this.out._activateSignal(e)}_onEnded(e,s){const t=s._getExecutionVariable(this,"runningTimers")||[],a=t.indexOf(e);-1!==a?t.splice(a,1):i.S0.Warn("FlowGraphTimerBlock: Timer ended but was not found in the running timers list"),s._removePendingBlock(this),this.done._activateSignal(s)}_cancelPendingTasks(e){const s=e._getExecutionVariable(this,"runningTimers")||[];for(const e of s)e.dispose();e._deleteExecutionVariable(this,"runningTimers")}getClassName(){return K.ClassName}}K.ClassName="FGTimerBlock",(0,r.Y5)("FGTimerBlock",K);class H extends A{constructor(e){super(e),this.config=e;for(let e=0;e<this.config.eventData.length;e++){const s=this.config.eventData[e];this.registerDataInput(s,p)}}_execute(e){const s=this.config.eventId,t=this.dataInputs.map((s=>s.getValue(e)));e.configuration.coordinator.notifyCustomEvent(s,t),this.out._activateSignal(e)}getClassName(){return H.ClassName}}H.ClassName="FGSendCustomEventBlock",(0,r.Y5)("FGSendCustomEventBlock",H);class Z extends G{constructor(e){super(e),this.config=e;for(let e=0;e<this.config.eventData.length;e++){const s=this.config.eventData[e];this.registerDataOutput(s,p)}}_preparePendingTasks(e){const s=e.configuration.coordinator.getCustomEventObservable(this.config.eventId);this._eventObserver=s.add((s=>{for(let t=0;t<s.length;t++)this.dataOutputs[t].setValue(s[t],e);this._execute(e)}))}_cancelPendingTasks(e){const s=e.configuration.coordinator.getCustomEventObservable(this.config.eventId);s?s.remove(this._eventObserver):i.S0.Warn(`FlowGraphReceiveCustomEventBlock: Missing observable for event ${this.config.eventId}`)}getClassName(){return Z.ClassName}serialize(e){super.serialize(e),e.eventId=this.config.eventId,e.eventData=this.config.eventData}}Z.ClassName="FGReceiveCustomEventBlock",(0,r.Y5)(Z.ClassName,Z);class j extends B{constructor(e){super(e),this.config=e,this.outFlows=[];for(let e=0;e<this.config.numberOutputFlows;e++)this.outFlows.push(this._registerSignalOutput(`${e}`))}_execute(e){for(let s=0;s<this.config.numberOutputFlows;s++)this.outFlows[s]._activateSignal(e)}getClassName(){return j.ClassName}}j.ClassName="FGSequenceBlock",(0,r.Y5)(j.ClassName,j);const Q=new RegExp(/\{(\w+)\}/g);class W{constructor(e,s){this.path=e,this.ownerBlock=s,this.templatedInputs=[];let t=Q.exec(e);for(;t;){const[,a]=t;this.templatedInputs.push(s.registerDataInput(a,f)),t=Q.exec(e)}}getAccessor(e,s){let t=this.path;for(const e of this.templatedInputs){const a=e.getValue(s).value;t=t.replace(`{${e.name}}`,a.toString())}return e.convert(t)}}class X extends b{constructor(e){super(e),this.config=e,this.value=this.registerDataOutput("value",p),this.templateComponent=new W(e.path,this)}_updateOutputs(e){const s=this.templateComponent.getAccessor(this.config.pathConverter,e),t=s.info.get(s.object);this.value.setValue(t,e)}getClassName(){return X.ClassName}serialize(e={}){super.serialize(e),e.config.path=this.config.path}}X.ClassName="FGGetPropertyBlock",(0,r.Y5)(X.ClassName,X);class J extends A{constructor(e){super(e),this.config=e,this.a=this.registerDataInput("a",p),this.templateComponent=new W(e.path,this)}_execute(e){const s=this.a.getValue(e),t=this.templateComponent.getAccessor(this.config.pathConverter,e);t.info.set(s,t.object),this.out._activateSignal(e)}serialize(e={}){super.serialize(e),e.config.path=this.config.path}getClassName(){return J.ClassName}}J.ClassName="FGSetPropertyBlock",(0,r.Y5)("FGSetPropertyBlock",J);const ee="cachedOperationValue",se="cachedExecutionId";class te extends b{constructor(e,s){super(s),this.value=this.registerDataOutput("value",e)}_updateOutputs(e){const s=e._getExecutionVariable(this,se),t=e._getExecutionVariable(this,ee);if(void 0!==t&&s===e.executionId)this.value.setValue(t,e);else{const s=this._doOperation(e);e._setExecutionVariable(this,ee,s),e._setExecutionVariable(this,se,e.executionId),this.value.setValue(s,e)}}}class ae extends te{constructor(e,s,t,a,n,o){super(t,o),this._operation=a,this._className=n,this.a=this.registerDataInput("a",e),this.b=this.registerDataInput("b",s)}_doOperation(e){return this._operation(this.a.getValue(e),this.b.getValue(e))}getClassName(){return this._className}}class ne extends te{constructor(e,s,t,a){super(e,a),this._operation=s,this._className=t}_doOperation(e){return this._operation()}getClassName(){return this._className}}class oe extends te{constructor(e,s,t,a,n){super(s,n),this._operation=t,this._className=a,this.a=this.registerDataInput("a",e)}_doOperation(e){return this._operation(this.a.getValue(e))}getClassName(){return this._className}}class re extends te{constructor(e,s,t,a,n,o,r){super(a,r),this._operation=n,this._className=o,this.a=this.registerDataInput("a",e),this.b=this.registerDataInput("b",s),this.c=this.registerDataInput("c",t)}_doOperation(e){return this._operation(this.a.getValue(e),this.b.getValue(e),this.c.getValue(e))}getClassName(){return this._className}}function ie(e){return e.getClassName?e.getClassName():""}function ce(e,s){return"Vector2"===e&&"Vector2"===s||"Vector3"===e&&"Vector3"===s||"Vector4"===e&&"Vector4"===s}function le(e,s){return"Matrix"===e&&"Matrix"===s}function ue(e,s){return"FlowGraphInteger"===e&&"FlowGraphInteger"===s}class he extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicAdd(e,s)),he.ClassName,e)}_polymorphicAdd(e,s){const t=ie(e),a=ie(s);return ce(t,a)||le(t,a)||ue(t,a)?e.add(s):e+s}}he.ClassName="FGAddBlock",(0,r.Y5)(he.ClassName,he);class me extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicAdd(e,s)),me.ClassName,e)}_polymorphicAdd(e,s){const t=ie(e),a=ie(s);return ce(t,a)||ue(t,a)?e.subtract(s):le(t,a)?e.add(s.scale(-1)):e-s}}me.ClassName="FGSubBlock",(0,r.Y5)(me.ClassName,me);class pe extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicMultiply(e,s)),pe.ClassName,e)}_polymorphicMultiply(e,s){const t=ie(e),a=ie(s);return ce(t,a)||ue(t,a)?e.multiply(s):le(t,a)?l.uq.FromValues(e.m[0]*s.m[0],e.m[4]*s.m[4],e.m[8]*s.m[8],e.m[12]*s.m[12],e.m[1]*s.m[1],e.m[5]*s.m[5],e.m[9]*s.m[9],e.m[13]*s.m[13],e.m[2]*s.m[2],e.m[6]*s.m[6],e.m[10]*s.m[10],e.m[14]*s.m[14],e.m[3]*s.m[3],e.m[7]*s.m[7],e.m[11]*s.m[11],e.m[15]*s.m[15]):e*s}}pe.ClassName="FGMultiplyBlock",(0,r.Y5)(pe.ClassName,pe);class de extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicDivide(e,s)),de.ClassName,e)}_polymorphicDivide(e,s){const t=ie(e),a=ie(s);return ce(t,a)||ue(t,a)?e.divide(s):le(t,a)?l.uq.FromValues(e.m[0]/s.m[0],e.m[4]/s.m[4],e.m[8]/s.m[8],e.m[12]/s.m[12],e.m[1]/s.m[1],e.m[5]/s.m[5],e.m[9]/s.m[9],e.m[13]/s.m[13],e.m[2]/s.m[2],e.m[6]/s.m[6],e.m[10]/s.m[10],e.m[14]/s.m[14],e.m[3]/s.m[3],e.m[7]/s.m[7],e.m[11]/s.m[11],e.m[15]/s.m[15]):e/s}}de.ClassName="FGDivideBlock",(0,r.Y5)(de.ClassName,de);class Ce extends ne{constructor(e){super(d,(()=>Math.random()),Ce.ClassName,e)}}Ce.ClassName="FGRandomBlock",(0,r.Y5)(Ce.ClassName,Ce);class Ne extends ae{constructor(e){super(p,p,d,((e,s)=>this._polymorphicDot(e,s)),Ne.ClassName,e)}_polymorphicDot(e,s){switch(ie(e)){case"Vector2":return l.I9.Dot(e,s);case"Vector3":return l.Pq.Dot(e,s);case"Vector4":return l.IU.Dot(e,s);default:throw new Error(`Cannot get dot product of ${e} and ${s}`)}}}Ne.ClassName="FGDotBlock",(0,r.Y5)(Ne.ClassName,Ne);class _e extends ne{constructor(e){super(d,(()=>Math.E),_e.ClassName,e)}}_e.ClassName="FGEBlock",(0,r.Y5)(_e.ClassName,_e);class ge extends ne{constructor(e){super(d,(()=>Math.PI),ge.ClassName,e)}}ge.ClassName="FGPIBlock",(0,r.Y5)(ge.ClassName,ge);class fe extends ne{constructor(e){super(d,(()=>Number.POSITIVE_INFINITY),fe.ClassName,e)}}fe.ClassName="FGInfBlock",(0,r.Y5)(fe.ClassName,fe);class ve extends ne{constructor(e){super(d,(()=>Number.NaN),ve.ClassName,e)}}function xe(e,s){switch(ie(e)){case"FlowGraphInteger":return new h(s(e.value));case"Vector2":return new l.I9(s(e.x),s(e.y));case"Vector3":return new l.Pq(s(e.x),s(e.y),s(e.z));case"Vector4":return new l.IU(s(e.x),s(e.y),s(e.z),s(e.w));case"Matrix":return l.uq.FromValues(s(e.m[0]),s(e.m[4]),s(e.m[8]),s(e.m[12]),s(e.m[1]),s(e.m[5]),s(e.m[9]),s(e.m[13]),s(e.m[2]),s(e.m[6]),s(e.m[10]),s(e.m[14]),s(e.m[3]),s(e.m[7]),s(e.m[11]),s(e.m[15]));default:return s(e)}}ve.ClassName="FGNaNBlock",(0,r.Y5)(ve.ClassName,ve);class ye extends oe{constructor(e){super(p,p,(e=>this._polymorphicAbs(e)),ye.ClassName,e)}_polymorphicAbs(e){return xe(e,Math.abs)}}ye.ClassName="FGAbsBlock",(0,r.Y5)(ye.ClassName,ye);class we extends oe{constructor(e){super(p,p,(e=>this._polymorphicSign(e)),we.ClassName,e)}_polymorphicSign(e){return xe(e,Math.sign)}}we.ClassName="FGSignBlock",(0,r.Y5)(we.ClassName,we);class Ie extends oe{constructor(e){super(p,p,(e=>this._polymorphicTrunc(e)),Ie.ClassName,e)}_polymorphicTrunc(e){return xe(e,Math.trunc)}}Ie.ClassName="FGTruncBlock",(0,r.Y5)(Ie.ClassName,Ie);class be extends oe{constructor(e){super(p,p,(e=>this._polymorphicFloor(e)),be.ClassName,e)}_polymorphicFloor(e){return xe(e,Math.floor)}}be.ClassName="FGFloorBlock",(0,r.Y5)(be.ClassName,be);class ke extends oe{constructor(e){super(p,p,(e=>this._polymorphicCeiling(e)),ke.ClassName,e)}_polymorphicCeiling(e){return xe(e,Math.ceil)}}ke.ClassName="FGCeilBlock",(0,r.Y5)(ke.ClassName,ke);class Be extends oe{constructor(e){super(p,p,(e=>this._polymorphicFract(e)),Be.ClassName,e)}_polymorphicFract(e){return xe(e,(e=>e-Math.floor(e)))}}Be.ClassName="FGFractBlock",(0,r.Y5)(Be.ClassName,Be);class Ve extends oe{constructor(e){super(p,p,(e=>this._polymorphicNeg(e)),Ve.ClassName,e)}_polymorphicNeg(e){return xe(e,(e=>-e))}}function Ge(e,s,t){switch(ie(e)){case"FlowGraphInteger":return new h(t(e.value,s.value));case"Vector2":return new l.I9(t(e.x,s.x),t(e.y,s.y));case"Vector3":return new l.Pq(t(e.x,s.x),t(e.y,s.y),t(e.z,s.z));case"Vector4":return new l.IU(t(e.x,s.x),t(e.y,s.y),t(e.z,s.z),t(e.w,s.w));case"Matrix":return l.uq.FromValues(t(e.m[0],s.m[0]),t(e.m[4],s.m[4]),t(e.m[8],s.m[8]),t(e.m[12],s.m[12]),t(e.m[1],s.m[1]),t(e.m[5],s.m[5]),t(e.m[9],s.m[9]),t(e.m[13],s.m[13]),t(e.m[2],s.m[2]),t(e.m[6],s.m[6]),t(e.m[10],s.m[10]),t(e.m[14],s.m[14]),t(e.m[3],s.m[3]),t(e.m[7],s.m[7]),t(e.m[11],s.m[11]),t(e.m[15],s.m[15]));default:return t(e,s)}}Ve.ClassName="FGNegBlock",(0,r.Y5)(Ve.ClassName,Ve);class Fe extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicRemainder(e,s)),Fe.ClassName,e)}_polymorphicRemainder(e,s){return Ge(e,s,((e,s)=>e%s))}}Fe.ClassName="FGRemainderBlock",(0,r.Y5)(Fe.ClassName,Fe);class Ee extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicMin(e,s)),Ee.ClassName,e)}_polymorphicMin(e,s){return Ge(e,s,Math.min)}}Ee.ClassName="FGMinBlock",(0,r.Y5)(Ee.ClassName,Ee);class Oe extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicMax(e,s)),Oe.ClassName,e)}_polymorphicMax(e,s){return Ge(e,s,Math.max)}}function Pe(e,s,t){return Math.min(Math.max(e,Math.min(s,t)),Math.max(s,t))}function Te(e,s,t,a){switch(ie(e)){case"FlowGraphInteger":return new h(a(e.value,s.value,t.value));case"Vector2":return new l.I9(a(e.x,s.x,t.x),a(e.y,s.y,t.y));case"Vector3":return new l.Pq(a(e.x,s.x,t.x),a(e.y,s.y,t.y),a(e.z,s.z,t.z));case"Vector4":return new l.IU(a(e.x,s.x,t.x),a(e.y,s.y,t.y),a(e.z,s.z,t.z),a(e.w,s.w,t.w));case"Matrix":return l.uq.FromValues(a(e.m[0],s.m[0],t.m[0]),a(e.m[4],s.m[4],t.m[4]),a(e.m[8],s.m[8],t.m[8]),a(e.m[12],s.m[12],t.m[12]),a(e.m[1],s.m[1],t.m[1]),a(e.m[5],s.m[5],t.m[5]),a(e.m[9],s.m[9],t.m[9]),a(e.m[13],s.m[13],t.m[13]),a(e.m[2],s.m[2],t.m[2]),a(e.m[6],s.m[6],t.m[6]),a(e.m[10],s.m[10],t.m[10]),a(e.m[14],s.m[14],t.m[14]),a(e.m[3],s.m[3],t.m[3]),a(e.m[7],s.m[7],t.m[7]),a(e.m[11],s.m[11],t.m[11]),a(e.m[15],s.m[15],t.m[15]));default:return a(e,s,t)}}Oe.ClassName="FGMaxBlock",(0,r.Y5)(Oe.ClassName,Oe);class qe extends re{constructor(e){super(p,p,p,p,((e,s,t)=>this._polymorphicClamp(e,s,t)),qe.ClassName,e)}_polymorphicClamp(e,s,t){return Te(e,s,t,Pe)}}function Me(e){return Math.min(Math.max(e,0),1)}qe.ClassName="FGClampBlock",(0,r.Y5)(qe.ClassName,qe);class Ye extends oe{constructor(e){super(p,p,(e=>this._polymorphicSaturate(e)),Ye.ClassName,e)}_polymorphicSaturate(e){return xe(e,Me)}}Ye.ClassName="FGSaturateBlock",(0,r.Y5)(Ye.ClassName,Ye);class Se extends re{constructor(e){super(p,p,p,p,((e,s,t)=>this._polymorphicInterpolate(e,s,t)),Se.ClassName,e)}_interpolate(e,s,t){return(1-t)*e+t*s}_polymorphicInterpolate(e,s,t){return Te(e,s,t,this._interpolate)}}Se.ClassName="FGInterpolateBlock",(0,r.Y5)(Se.ClassName,Se);class De extends ae{constructor(e){super(p,p,C,((e,s)=>this._polymorphicEq(e,s)),De.ClassName,e)}_polymorphicEq(e,s){const t=ie(e),a=ie(s);return ce(t,a)||le(t,a)||ue(t,a)?e.equals(s):e===s}}function ze(e,s,t){const a=ie(e);if(a===ie(s)){if(""===a)return t(e,s);if("FlowGraphInteger"===a)return t(e.value,s.value);throw new Error(`Cannot compare ${e} and ${s}`)}throw new Error(`${e} and ${s} are of different types.`)}De.ClassName="FGEqBlock",(0,r.Y5)(De.ClassName,De);class Re extends ae{constructor(e){super(p,p,C,((e,s)=>this._polymorphicLessThan(e,s)),Re.ClassName,e)}_polymorphicLessThan(e,s){return ze(e,s,((e,s)=>e<s))}}Re.ClassName="FGLessThanBlock",(0,r.Y5)(Re.ClassName,Re);class Ae extends ae{constructor(e){super(p,p,C,((e,s)=>this._polymorphicLessThanOrEqual(e,s)),Ae.ClassName,e)}_polymorphicLessThanOrEqual(e,s){return ze(e,s,((e,s)=>e<=s))}}Ae.ClassName="FGLessThanOrEqualBlock";class $e extends ae{constructor(e){super(p,p,C,((e,s)=>this._polymorphicGreaterThan(e,s)),$e.ClassName,e)}_polymorphicGreaterThan(e,s){return ze(e,s,((e,s)=>e>s))}}$e.ClassName="FGGreaterThanBlock",(0,r.Y5)($e.ClassName,$e);class Le extends ae{constructor(e){super(p,p,C,((e,s)=>this._polymorphicGreaterThanOrEqual(e,s)),Le.ClassName,e)}_polymorphicGreaterThanOrEqual(e,s){return ze(e,s,((e,s)=>e>=s))}}Le.ClassName="FGGreaterThanOrEqualBlock",(0,r.Y5)(Le.ClassName,Le);class Ue extends oe{constructor(e){super(p,C,(e=>this._polymorphicIsNan(e)),Ue.ClassName,e)}_polymorphicIsNan(e){const s=ie(e);if(""===s)return isNaN(e);if("FlowGraphInteger"===s)return isNaN(e.value);throw new Error(`Cannot get NaN of ${e}`)}}Ue.ClassName="FGIsNanBlock",(0,r.Y5)(Ue.ClassName,Ue);class Ke extends oe{constructor(e){super(p,C,(e=>this._polymorphicIsInf(e)),Ke.ClassName,e)}_polymorphicIsInf(e){const s=ie(e);if(""===s)return!isFinite(e);if("FlowGraphInteger"===s)return!isFinite(e.value);throw new Error(`Cannot get isInf of ${e}`)}}Ke.ClassName="FGIsInfBlock";class He extends oe{constructor(e){super(p,p,(e=>this._polymorphicDegToRad(e)),He.ClassName,e)}_degToRad(e){return e*Math.PI/180}_polymorphicDegToRad(e){return xe(e,this._degToRad)}}He.ClassName="FGDegToRadBlock",(0,r.Y5)(He.ClassName,He);class Ze extends oe{constructor(e){super(p,p,(e=>this._polymorphicRadToDeg(e)),Ze.ClassName,e)}_radToDeg(e){return 180*e/Math.PI}_polymorphicRadToDeg(e){return xe(e,this._radToDeg)}}Ze.ClassName="FGRadToDegBlock",(0,r.Y5)(Ze.ClassName,Ze);class je extends oe{constructor(e){super(p,p,(e=>this._polymorphicSin(e)),je.ClassName,e)}_polymorphicSin(e){return xe(e,Math.sin)}}je.ClassName="FGSinBlock",(0,r.Y5)(je.ClassName,je);class Qe extends oe{constructor(e){super(p,p,(e=>this._polymorphicCos(e)),Qe.ClassName,e)}_polymorphicCos(e){return xe(e,Math.cos)}}Qe.ClassName="FGCosBlock",(0,r.Y5)(Qe.ClassName,Qe);class We extends oe{constructor(e){super(p,p,(e=>this._polymorphicTan(e)),We.ClassName,e)}_polymorphicTan(e){return xe(e,Math.tan)}}We.ClassName="FGTanBlock",(0,r.Y5)(We.ClassName,We);class Xe extends oe{constructor(e){super(p,p,(e=>this._polymorphicAsin(e)),Xe.ClassName,e)}_polymorphicAsin(e){return xe(e,Math.asin)}}Xe.ClassName="FGAsinBlock",(0,r.Y5)(Xe.ClassName,Xe);class Je extends oe{constructor(e){super(p,p,(e=>this._polymorphicAcos(e)),Je.ClassName,e)}_polymorphicAcos(e){return xe(e,Math.acos)}}Je.ClassName="FGAcosBlock",(0,r.Y5)(Je.ClassName,Je);class es extends oe{constructor(e){super(p,p,(e=>this._polymorphicAtan(e)),es.ClassName,e)}_polymorphicAtan(e){return xe(e,Math.atan)}}es.ClassName="FGAtanBlock",(0,r.Y5)(es.ClassName,es);class ss extends ae{constructor(e){super(p,p,p,((e,s)=>this._polymorphicAtan2(e,s)),ss.ClassName,e)}_polymorphicAtan2(e,s){return Ge(e,s,Math.atan2)}}ss.ClassName="FGAtan2Block",(0,r.Y5)(ss.ClassName,ss);class ts extends oe{constructor(e){super(p,p,(e=>this._polymorphicSinh(e)),ts.ClassName,e)}_polymorphicSinh(e){return xe(e,Math.sinh)}}ts.ClassName="FGSinhBlock",(0,r.Y5)(ts.ClassName,ts);class as extends oe{constructor(e){super(p,p,(e=>this._polymorphicCosh(e)),as.ClassName,e)}_polymorphicCosh(e){return xe(e,Math.cosh)}}as.ClassName="FGCoshBlock",(0,r.Y5)(as.ClassName,as);class ns extends oe{constructor(e){super(p,p,(e=>this._polymorphicTanh(e)),ns.ClassName,e)}_polymorphicTanh(e){return xe(e,Math.tanh)}}ns.ClassName="FGTanhBlock",(0,r.Y5)(ns.ClassName,ns);class os extends oe{constructor(e){super(p,d,(e=>this._polymorphicAsinh(e)),os.ClassName,e)}_polymorphicAsinh(e){return xe(e,Math.asinh)}}os.ClassName="FGAsinhBlock",(0,r.Y5)(os.ClassName,os);class rs extends oe{constructor(e){super(p,d,(e=>this._polymorphicAcosh(e)),rs.ClassName,e)}_polymorphicAcosh(e){return xe(e,Math.acosh)}}rs.ClassName="FGAcoshBlock",(0,r.Y5)(rs.ClassName,rs);class is extends oe{constructor(e){super(p,d,(e=>this._polymorphicAtanh(e)),is.ClassName,e)}_polymorphicAtanh(e){return xe(e,Math.atanh)}}is.ClassName="FGAtanhBlock",(0,r.Y5)(is.ClassName,is);class cs extends oe{constructor(e){super(p,d,(e=>this._polymorphicExp(e)),cs.ClassName,e)}_polymorphicExp(e){return xe(e,Math.exp)}}cs.ClassName="FGExpBlock",(0,r.Y5)(cs.ClassName,cs);class ls extends oe{constructor(e){super(p,d,(e=>this._polymorphicLog(e)),ls.ClassName,e)}_polymorphicLog(e){return xe(e,Math.log)}}ls.ClassName="FGLogBlock",(0,r.Y5)(ls.ClassName,ls);class us extends oe{constructor(e){super(p,d,(e=>this._polymorphicLog2(e)),us.ClassName,e)}_polymorphicLog2(e){return xe(e,Math.log2)}}us.ClassName="FGLog2Block",(0,r.Y5)(us.ClassName,us);class hs extends oe{constructor(e){super(p,d,(e=>this._polymorphicLog10(e)),hs.ClassName,e)}_polymorphicLog10(e){return xe(e,Math.log10)}}hs.ClassName="FGLog10Block",(0,r.Y5)(hs.ClassName,hs);class ms extends oe{constructor(e){super(p,d,(e=>this._polymorphicSqrt(e)),ms.ClassName,e)}_polymorphicSqrt(e){return xe(e,Math.sqrt)}}ms.ClassName="FGSqrtBlock",(0,r.Y5)(ms.ClassName,ms);class ps extends oe{constructor(e){super(p,d,(e=>this._polymorphicCubeRoot(e)),ps.ClassName,e)}_polymorphicCubeRoot(e){return xe(e,Math.cbrt)}}ps.ClassName="FGCubeRootBlock",(0,r.Y5)(ps.ClassName,ps);class ds extends ae{constructor(e){super(p,d,d,((e,s)=>this._polymorphicPow(e,s)),ds.ClassName,e)}_polymorphicPow(e,s){return Ge(e,s,Math.pow)}}ds.ClassName="FGPowBlock",(0,r.Y5)(ds.ClassName,ds);class Cs extends oe{constructor(e){super(p,d,(e=>this._polymorphicLength(e)),Cs.ClassName,e)}_polymorphicLength(e){switch(ie(e)){case"Vector2":case"Vector3":case"Vector4":return e.length();default:throw new Error(`Cannot compute length of value ${e}`)}}}Cs.ClassName="FGLengthBlock",(0,r.Y5)(Cs.ClassName,Cs);class Ns extends oe{constructor(e){super(p,p,(e=>this._polymorphicNormalize(e)),Ns.ClassName,e)}_polymorphicNormalize(e){switch(ie(e)){case"Vector2":case"Vector3":case"Vector4":return e.normalize();default:throw new Error(`Cannot normalize value ${e}`)}}}Ns.ClassName="FGNormalizeBlock",(0,r.Y5)(Ns.ClassName,Ns);class _s extends ae{constructor(e){super(_,_,_,((e,s)=>l.Pq.Cross(e,s)),_s.ClassName,e)}}_s.ClassName="FGCrossBlock",(0,r.Y5)(_s.ClassName,_s);class gs extends ae{constructor(e){super(N,d,N,((e,s)=>l.I9.Transform(e,l.uq.RotationZ(s))),gs.ClassName,e)}}gs.ClassName="FGRotate2DBlock",(0,r.Y5)(gs.ClassName,gs);class fs extends re{constructor(e){super(_,_,d,_,((e,s,t)=>l.Pq.TransformCoordinates(e,l.uq.RotationAxis(s,t))),fs.ClassName,e)}}fs.ClassName="FGRotate3DBlock",(0,r.Y5)(fs.ClassName,fs);class vs extends oe{constructor(e){super(g,g,(e=>l.uq.Transpose(e)),vs.ClassName,e)}}vs.ClassName="FGTransposeBlock",(0,r.Y5)(vs.ClassName,vs);class xs extends oe{constructor(e){super(g,d,(e=>e.determinant()),xs.ClassName,e)}}xs.ClassName="FGDeterminantBlock",(0,r.Y5)(xs.ClassName,xs);class ys extends oe{constructor(e){super(g,g,(e=>l.uq.Invert(e)),ys.ClassName,e)}}ys.ClassName="FGInvertMatrixBlock",(0,r.Y5)(ys.ClassName,ys);class ws extends ae{constructor(e){super(g,g,g,((e,s)=>s.multiply(e)),ws.ClassName,e)}}ws.ClassName="FGMatMulBlock",(0,r.Y5)(ws.ClassName,ws);class Is extends oe{constructor(e){super(f,f,(e=>new h(~e.value)),Is.ClassName,e)}}Is.ClassName="FGBitwiseNotBlock",(0,r.Y5)(Is.ClassName,Is);class bs extends ae{constructor(e){super(f,f,f,((e,s)=>new h(e.value&s.value)),bs.ClassName,e)}}bs.ClassName="FGBitwiseAndBlock",(0,r.Y5)(bs.ClassName,bs);class ks extends ae{constructor(e){super(f,f,f,((e,s)=>new h(e.value|s.value)),ks.ClassName,e)}}ks.ClassName="FGBitwiseOrBlock",(0,r.Y5)(ks.ClassName,ks);class Bs extends ae{constructor(e){super(f,f,f,((e,s)=>new h(e.value^s.value)),Bs.ClassName,e)}}Bs.ClassName="FGBitwiseXorBlock",(0,r.Y5)(Bs.ClassName,Bs);class Vs extends ae{constructor(e){super(f,f,f,((e,s)=>new h(e.value<<s.value)),Vs.ClassName,e)}}Vs.ClassName="FGBitwiseLeftShiftBlock",(0,r.Y5)(Vs.ClassName,Vs);class Gs extends ae{constructor(e){super(f,f,f,((e,s)=>new h(e.value>>s.value)),Gs.ClassName,e)}}Gs.ClassName="FGBitwiseRightShiftBlock",(0,r.Y5)(Gs.ClassName,Gs);class Fs extends oe{constructor(e){super(f,f,(e=>new h(Math.clz32(e.value))),Fs.ClassName,e)}}Fs.ClassName="FGCountLeadingZerosBlock",(0,r.Y5)(Fs.ClassName,Fs);class Es extends oe{constructor(e){super(f,f,(e=>new h(e.value?31-Math.clz32(e.value&-e.value):32)),Es.ClassName,e)}}Es.ClassName="FGCountTrailingZerosBlock",(0,r.Y5)(Es.ClassName,Es);class Os extends oe{constructor(e){super(f,f,(e=>new h(function(e){let s=0;for(;e;)s+=1&e,e>>=1;return s}(e.value))),Os.ClassName,e)}}Os.ClassName="FGCountOneBitsBlock",(0,r.Y5)(Os.ClassName,Os);class Ps extends A{constructor(e={startIndex:new h(0)}){super(e),this.config=e,this.reset=this._registerSignalInput("reset"),this.n=this.registerDataInput("n",f),this.value=this.registerDataOutput("value",f)}_execute(e,s){if(s===this.reset)this.value.setValue(this.config.startIndex,e);else{const s=this.value.getValue(e);s.value<this.n.getValue(e).value&&(this.value.setValue(new h(s.value+1),e),this.out._activateSignal(e))}}getClassName(){return Ps.ClassName}}Ps.ClassName="FGDoNBlock",(0,r.Y5)(Ps.ClassName,Ps);class Ts extends b{constructor(e){super(e),this.config=e,this.output=this.registerDataOutput(e.variableName,p)}_updateOutputs(e){const s=this.config.variableName;e.hasVariable(s)&&this.output.setValue(e.getVariable(s),e)}getClassName(){return Ts.ClassName}serialize(e){super.serialize(e),e.config.variableName=this.config.variableName}}Ts.ClassName="FGGetVariableBlock",(0,r.Y5)(Ts.ClassName,Ts);class qs extends A{constructor(e){super(e),this.config=e,this.input=this.registerDataInput(e.variableName,p)}_execute(e){const s=this.config.variableName,t=this.input.getValue(e);e.setVariable(s,t),this.out._activateSignal(e)}getClassName(){return qs.ClassName}}qs.ClassName="FGSetVariableBlock",(0,r.Y5)(qs.ClassName,qs);class Ms extends A{constructor(e){super(e),this.config=e,this.condition=this.registerDataInput("condition",C),this.loopBody=this._registerSignalOutput("loopBody")}_execute(e,s){let t=this.condition.getValue(e);for(this.config?.isDo&&!t&&this.loopBody._activateSignal(e);t;)this.loopBody._activateSignal(e),t=this.condition.getValue(e);this.out._activateSignal(e)}getClassName(){return Ms.ClassName}serialize(e){super.serialize(e),e.isDo=this.config?.isDo}}Ms.ClassName="FGWhileLoopBlock",(0,r.Y5)(Ms.ClassName,Ms);const Ys={"lifecycle/onStart":z.ClassName,"lifecycle/onTick":R.ClassName,log:L.ClassName,"flow/delay":K.ClassName,"customEvent/send":H.ClassName,"customEvent/receive":Z.ClassName,"flow/sequence":j.ClassName,"world/get":X.ClassName,"world/set":J.ClassName,"flow/doN":Ps.ClassName,"variable/get":Ts.ClassName,"variable/set":qs.ClassName,"flow/whileLoop":Ms.ClassName,"math/random":Ce.ClassName,"math/e":_e.ClassName,"math/pi":ge.ClassName,"math/inf":fe.ClassName,"math/nan":ve.ClassName,"math/abs":ye.ClassName,"math/sign":we.ClassName,"math/trunc":Ie.ClassName,"math/floor":be.ClassName,"math/ceil":ke.ClassName,"math/fract":Be.ClassName,"math/neg":Ve.ClassName,"math/add":he.ClassName,"math/sub":me.ClassName,"math/mul":pe.ClassName,"math/div":de.ClassName,"math/rem":Fe.ClassName,"math/min":Ee.ClassName,"math/max":Oe.ClassName,"math/clamp":qe.ClassName,"math/saturate":Ye.ClassName,"math/mix":Se.ClassName,"math/eq":De.ClassName,"math/lt":Re.ClassName,"math/le":Ae.ClassName,"math/gt":$e.ClassName,"math/ge":Le.ClassName,"math/isnan":Ue.ClassName,"math/isinf":Ke.ClassName,"math/rad":He.ClassName,"math/deg":Ze.ClassName,"math/sin":je.ClassName,"math/cos":Qe.ClassName,"math/tan":We.ClassName,"math/asin":Xe.ClassName,"math/acos":Je.ClassName,"math/atan":es.ClassName,"math/atan2":ss.ClassName,"math/sinh":ts.ClassName,"math/cosh":as.ClassName,"math/tanh":ns.ClassName,"math/asinh":os.ClassName,"math/acosh":rs.ClassName,"math/atanh":is.ClassName,"math/exp":cs.ClassName,"math/log":ls.ClassName,"math/log2":us.ClassName,"math/log10":hs.ClassName,"math/sqrt":ms.ClassName,"math/cbrt":ps.ClassName,"math/pow":ds.ClassName,"math/length":Cs.ClassName,"math/normalize":Ns.ClassName,"math/dot":Ne.ClassName,"math/cross":_s.ClassName,"math/rotate2d":gs.ClassName,"math/rotate3d":fs.ClassName,"math/transpose":vs.ClassName,"math/determinant":xs.ClassName,"math/inverse":ys.ClassName,"math/matmul":ws.ClassName,"math/not":Is.ClassName,"math/and":bs.ClassName,"math/or":ks.ClassName,"math/xor":Bs.ClassName,"math/asr":Gs.ClassName,"math/lsl":Vs.ClassName,"math/clz":Fs.ClassName,"math/ctz":Es.ClassName,"math/popcnt":Os.ClassName},Ss={float2:"Vector2",float3:"Vector3",float4:"Vector4",float4x4:"Matrix",int:"FlowGraphInteger"};function Ds(e,s,t){if(void 0!==e.type){const a=s.types&&s.types[e.type];if(!a)throw new Error(`${t}: Unknown type: ${e.type}`);const n=a.signature;if(!n)throw new Error(`${t}: Type ${e.type} has no signature`);const o=Ss[n];return{value:e.value,className:o}}return e.value}function zs(e,s,t){const a=Ys[s.type];if(!a)throw new Error(`/extensions/KHR_interactivity/nodes/${e}: Unknown block type: ${s.type}`);const n=e.toString(),o=function(e,s,t){const a={},n=e.configuration??[];for(const e of n)if("customEvent"===e.id){const n=s.customEvents&&s.customEvents[e.value];if(!n)throw new Error(`/extensions/KHR_interactivity/nodes/${t}: Unknown custom event: ${e.value}`);a.eventId=n.id,a.eventData=n.values.map((e=>e.id))}else if("variable"===e.id){const n=s.variables&&s.variables[e.value];if(!n)throw new Error(`/extensions/KHR_interactivity/nodes/${t}: Unknown variable: ${e.value}`);a.variableName=n.id}else if("path"===e.id){const s=e.value;a.path=s}else a[e.id]=Ds(e,s,`/extensions/KHR_interactivity/nodes/${t}`);return a}(s,t,n);return{className:a,config:o,uniqueId:n,metadata:s.metadata,dataInputs:[],dataOutputs:[],signalInputs:[],signalOutputs:[]}}var Rs=t(3150);class As extends Rs.z{constructor(e){super(e,$s)}}const $s={nodes:{__array__:{__target__:!0,translation:{type:"Vector3",get:e=>e._babylonTransformNode.position,set:(e,s)=>{s._babylonTransformNode.position=e},getObject:e=>e._babylonTransformNode}}}};var Ls=t(9046);const Us="KHR_interactivity";class Ks{constructor(e){this._loader=e,this.name=Us,this.enabled=this._loader.isExtensionUsed(Us),this._pathConverter=new As(this._loader.gltf)}dispose(){this._loader=null,delete this._pathConverter}onReady(){if(!this._loader.babylonScene||!this._pathConverter)return;const e=this._loader.babylonScene,s=this._loader.gltf.extensions?.KHR_interactivity,t=function(e){const s={uniqueId:(0,o.z)(),_userVariables:{},_connectionValues:{}},t=[s],a=[];for(let s=0;s<e.nodes.length;s++){const t=zs(s,e.nodes[s],e);a.push(t)}for(let t=0;t<e.nodes.length;t++){const n=e.nodes[t],r=a[t],i=n.flows??[];for(const e of i){const s=e.id,n={uniqueId:(0,o.z)(),name:s,_connectionType:1,connectedPointIds:[]};r.signalOutputs.push(n);const i=e.node,c=e.socket,l=a[i];if(!l)throw new Error(`/extensions/KHR_interactivity/nodes/${t}: Could not find node with id ${i} that connects its input with with node ${t}'s output ${s}`);let u=l.signalInputs.find((e=>e.name===c));u||(u={uniqueId:(0,o.z)(),name:c,_connectionType:0,connectedPointIds:[]},l.signalInputs.push(u)),u.connectedPointIds.push(n.uniqueId),n.connectedPointIds.push(u.uniqueId)}const c=n.values??[];for(const n of c){const i=n.id,c={uniqueId:(0,o.z)(),name:i,_connectionType:0,connectedPointIds:[]};if(r.dataInputs.push(c),void 0!==n.value){const a=Ds(n,e,`/extensions/KHR_interactivity/nodes/${t}`);s._connectionValues[c.uniqueId]=a}else{if(void 0===n.node||void 0===n.socket)throw new Error(`/extensions/KHR_interactivity/nodes/${t}: Invalid socket ${i} in node ${t}`);{const e=n.node,s=n.socket,r=a[e];if(!r)throw new Error(`/extensions/KHR_interactivity/nodes/${t}: Could not find node with id ${e} that connects its output with node${t}'s input ${i}`);let l=r.dataOutputs.find((e=>e.name===s));l||(l={uniqueId:(0,o.z)(),name:s,_connectionType:1,connectedPointIds:[]},r.dataOutputs.push(l)),c.connectedPointIds.push(l.uniqueId),l.connectedPointIds.push(c.uniqueId)}}}}const n=e.variables??[];for(let t=0;t<n.length;t++){const a=n[t],o=a.id;s._userVariables[o]=Ds(a,e,`/extensions/KHR_interactivity/variables/${t}`)}return{allBlocks:a,executionContexts:t}}(s),a=new D({scene:e});S.Parse(t,{coordinator:a,pathConverter:this._pathConverter}),a.start()}}(0,Ls.Hg)(Us),(0,Ls.Ye)(Us,!0,(e=>new Ks(e)))}}]);